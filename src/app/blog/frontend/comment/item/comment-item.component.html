<div class="comment-item" [id]="'comment-' + value.id">
    <div class="info">
        <span class="user">{{ value.name }}</span>
        <span class="time">{{ value.created_at | ago }}</span>
        <span class="floor">{{ value.position }}楼</span>
    </div>
    <div class="item-body">
        <div class="content">
            <app-rule-block [value]="value.content" [rules]="value.extra_rule"(tapped)="tapBlock($event)"></app-rule-block>
        </div>
        <ng-container *ngIf="value.reply_count && value.reply_count > 0">
            <span class="expand" *ngIf="!expanded" (click)="toggleExpand()">展开({{ value.reply_count }})</span>
            <span class="expand" *ngIf="expanded" (click)="toggleExpand()">折叠</span>
        </ng-container>
        
        <span>&nbsp;</span>
        <span class="comment" (click)="tapCommenting(value)"><i class="iconfont icon-commenting"></i></span>
        <span class="report" (click)="tapReport(value)">举报</span>
        <div class="actions">
            <span class="agree" (click)="tapAgree(value)"><i class="iconfont icon-thumbs-up"></i><b>{{ value.agree_count }}</b></span>
            <span class="disagree" (click)="tapDisagree(value)"><i class="iconfont icon-thumbs-down"></i><b>{{ value.disagree_count }}</b></span>
        </div>
    </div>

    <div *ngIf="expanded || editData.parent_id > 0" class="comments">
        <div class="comment-item" *ngFor="let it of value.replies"  [id]="'comment-' + it.id">
            <div class="info">
                <span class="user">{{ it.name }}</span>
                <span class="time">{{ it.created_at }}</span>
                <span class="floor">{{ it.position }}#</span>
            </div>
            <div class="item-body">
                <div class="content">
                    <app-rule-block [value]="it.content" [rules]="it.extra_rule"(tapped)="tapBlock($event)"></app-rule-block>
                </div>
                <span>&nbsp;</span>
                <span class="comment" (click)="tapCommenting(it)"><i class="iconfont icon-commenting"></i></span>
                <span class="report" (click)="tapReport(it)">举报</span>
                <div class="actions">
                    <span class="agree" (click)="tapAgree(it)"><i class="iconfont icon-thumbs-up"></i><b>{{ it.agree_count }}</b></span>
                    <span class="disagree" (click)="tapDisagree(it)"><i class="iconfont icon-thumbs-down"></i><b>{{ it.disagree_count }}</b></span>
                </div>
            </div>
        </div>
        <div class="book-comment-form" *ngIf="editData.parent_id > 0">
            <div class="title"> 回复评论 </div>
            <div class="form-table" *ngIf="!user">
                <div class="form-group">
                    <label>称呼</label>
                    <input type="text" [(ngModel)]="editData.name" placeholder="请输入姓名">
                </div>
                <div class="form-group">
                    <label>邮箱</label>
                    <input type="email" [(ngModel)]="editData.email" placeholder="请输入邮箱">
                </div>
                <div class="form-group">
                    <label>网址</label>
                    <input type="url" [(ngModel)]="editData.url" placeholder="请输入网址">
                </div>
            </div>
            <textarea [(ngModel)]="editData.content" placeholder="请输入内容"></textarea>
            <app-action-button class="btn btn-primary" (tapped)="tapComment($event)">回复</app-action-button>
            <button class="btn btn-secondary" (click)="tapCommenting()">取消</button>
        </div>
    </div>
    
</div>