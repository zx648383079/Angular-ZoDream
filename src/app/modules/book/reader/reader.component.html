<div class="container-fluid" #container [class]="{'scroll-up': scrollToUp || mode > 0}" >
  
    <div class="reader-box">
        <app-flip-pager [initChapter]="chapterId" [options]="configForm().value()" (progressChanged)="onProgressChange($event)" (previewRequest)="onRequest($event)" />
    </div>
    
    @if (isLoading()) {
    <div class="loading-bar" i18n>
        Loading ...
    </div>
    }

    <footer class="reader-footer" [style]="footerStyle" (click)="$event.stopPropagation()">
        <div class="pager">
            <a (click)="tapPrev()" i18n>Previous</a>
            <app-progress-bar [(value)]="progress" (valueChange)="onScrollChange()" />
            <a (click)="tapNext()" i18n>Next</a>
        </div>
        @if (mode == 2) {
        <div class="setting">
            <div class="line-item">
                <span i18n>Foreground</span>
                <div class="color-box">
                    <app-color-picker [field]="configForm.color">
                        <span class="color" [style]="{'background-color': configForm.color().value()}"></span>
                    </app-color-picker>
                </div>
            </div>
            <div class="line-item">
                <span i18n>Background</span>
                <div class="color-box">
                    <app-color-picker [field]="configForm.background" (valueChange)="onBackgroundChange()">
                        <span class="color" [style]="{'background-color': configForm.background().value()}"></span>
                    </app-color-picker>
                    <span class="add-img" (click)="tapBackgroundImg()">
                        <i class="iconfont icon-image"></i>
                    </span>
                </div>
            </div>
            <div class="line-item">
                <span i18n>Effect</span>
                <div class="font-box">
                    @for (item of flipItems; track $index; let i = $index) {
                        <span [class.active]="configForm.flip().value() == i" (click)="configForm.flip().value.set(i)">{{ item }}</span>
                    }
                    
                </div>
            </div>
            <div class="line-item">
                <span i18n>Font Family</span>
                <div class="font-box">
                    @for (item of fontItems; track $index; let i = $index) {
                        <span [class.active]="configForm.font().value() == i" (click)="configForm.font().value.set(i)">{{ item }}</span>
                    }
                </div>
            </div>
            <div class="line-item">
                <span i18n>Font Size</span>
                <div class="size-box">
                    <i class="iconfont icon-minus" (click)="tapMinus('size')"></i>
                    <span class="lang">{{ configForm.size().value() }}</span>
                    <i class="iconfont icon-plus" (click)="tapPlus('size')"></i>
                </div>
            </div>
            <div class="line-item">
                <span i18n>Line spacing</span>
                <div class="size-box">
                    <i class="iconfont icon-minus" (click)="tapMinus('line')"></i>
                    <span class="lang">{{ configForm.line().value() }}</span>
                    <i class="iconfont icon-plus" (click)="tapPlus('line')"></i>
                </div>
            </div>
            <div class="line-item">
                <span i18n>Letter spacing</span>
                <div class="size-box">
                    <i class="iconfont icon-minus" (click)="tapMinus('letter')"></i>
                    <span class="lang">{{ configForm.letter().value() }}</span>
                    <i class="iconfont icon-plus" (click)="tapPlus('letter')"></i>
                </div>
            </div>
        </div>
        }
        <div class="tab-bar">
            <a (click)="tapChapter()">
                <i class="iconfont icon-bars"></i>
                <ng-container i18n>Catalog</ng-container>
            </a>
            <a (click)="tapEye()" [class.active]="configForm.theme().value() == 7">
                <i class="iconfont icon-eye"></i>
                <ng-container i18n>Black</ng-container>
            </a>
            <a (click)="tapSetting()" [class]="{active: mode == 2}">
                <i class="iconfont icon-cog"></i>
                <ng-container i18n>Setting</ng-container>
            </a>
        </div>
    </footer>
</div>
