<div class="container">
    <app-pull-to-refresh [loading]="isLoading()" [more]="hasMore()" (moreChange)="tapMore()" (refreshChange)="tapRefresh()">
        <div class="row">
            @if (authUser) {
            <div class="col-md-4">
                <div class="note-form">
                    <div class="item-body">
                        <textarea class="form-control" [field]="editForm.content" placeholder="请输入内容"></textarea>
                    </div>
                    <div class="item-action">
                        <span class="length-box">{{ size() }}/255</span>
                        <div class="pull-right">
                            <a (click)="toggleVisible()" [title]="editForm.status().value() > 0 ? '公开显示' : '仅私人查看'"><i class="iconfont" [class]="{'icon-eye': editForm.status().value() > 0, 'icon-eye-slash': editForm.status().value() < 1}"></i></a>
                            <app-action-button (tapped)="tapSubmit($event)"><i class="iconfont icon-check"></i></app-action-button>
                        </div>
                    </div>
                </div>
            </div>
            }
    
            @for (item of items(); track $index) {
                <div class="col-md-4">
                <div class="note-item">
                    <div class="item-body" [innerHTML]="item.html"></div>
                    <div class="item-footer">
                        @if (item.user) {
                        <span>{{ item.user.name }}</span>
                        }
                        <span>{{ item.created_at | ago }}</span>
                    </div>
                    @if (item.editable) {
                    <div class="item-action">
                        <i class="iconfont icon-close" (click)="tapRemove(item)"></i>
                    </div>
                    }
                </div>
            </div>
            }
        </div>
        <app-loading-tip [loading]="isLoading()" [visible]="isLoading() || items().length == 0" />
    </app-pull-to-refresh>
</div>