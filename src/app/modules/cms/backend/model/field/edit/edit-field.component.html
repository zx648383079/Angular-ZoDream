<app-edit-header [title]="dataModel().id > 0 ? '编辑字段' : '新增字段'" (submited)="tapSubmit($event)" [disabled]="dataForm().invalid()" />

<div class="container-fluid">
    <form class="form-table-control panel-container" (submit)="tapSubmit2($event)">
        <div class="input-group-control">
            <label for="name">名称</label>
            <div>
                <input type="text" id="name" class="form-control" [formField]="dataForm.name">

            </div>
        </div>
        <div class="input-group-control">
            <label for="field">字段名</label>
            <div>
                <input type="text" id="field" class="form-control" [formField]="dataForm.field" >

            </div>
        </div>

        <div class="input-group-control">
            <label for="is_main">主表</label>
            <div>
                <app-switch id="is_main" [formField]="dataForm.is_main" />
            </div>
        </div>
        @if (!data || data().is_system < 1) {
        <div>
            <div class="input-group-control">
                <label for="type">类型</label>
                <div>
                    <select class="form-control" id="type" [formField]="dataForm.type" (change)="onTypeChange()">
                        @for (item of typeItems; track $index) {
                        <option [value]="item.value">{{ item.name }}</option>
                        }
                    </select>
                </div>
            </div>
            <div class="option-box" [formGroup]="optionForm()">
                @for (item of optionItems(); track $index) {
                    <div class="input-group-control">
                        <label>{{ item.label }}</label>
                        @switch (item.type) {
                            @case ('text') {
                                <div>
                                    <input type="text" class="form-control" [formControlName]="item.name">
                                </div>
                            }
                            @case ('textarea') {
                                <div>
                                    <textarea class="form-control" [formControlName]="item.name"></textarea>
                                </div>
                            }
                            @case ('select') {
                                <div>
                                    <select class="form-control" [formControlName]="item.name">
                                        @for (val of item.items; track $index) {
                                        <option [value]="val">{{ val }}</option>
                                        }
                                    </select>
                                </div>
                            }
                            @case ('radio') {
                                <div>
                                    <app-check-input [source]="item.optionSource" [formControlName]="item.name"/>
                                </div>
                            }
                            @case ('checkbox') {
                                <div>
                                    <app-check-input [source]="item.optionSource" [formControlName]="item.name" [multiple]="true"/>
                                </div>
                            }
                            @case ('switch') {
                                <div>
                                    <app-switch [formControlName]="item.name"/>
                                </div>
                            }
                        }
                    </div>
                }
            </div>
            <div class="input-group-control">
                <label for="is_required">是否必填</label>
                <div>
                    <app-switch id="is_required" [formField]="dataForm.is_required" />
                </div>
            </div>
            <div class="input-group-control">
                <label for="is_search">是否搜索</label>
                <div>
                    <app-switch id="is_search" [formField]="dataForm.is_search" />
                </div>
            </div>
            <div class="input-group-control">
                <label for="length">字段长度</label>
                <div>
                    <input type="text" id="length" class="form-control" [formField]="dataForm.length">

                </div>
            </div>
            <div class="input-group-control">
                <label for="match">匹配规则</label>
                <div>
                    <input type="text" id="match" class="form-control" [formField]="dataForm.match">

                </div>
            </div>
            <div class="input-group-control">
                <label for="tip_message">提示信息</label>
                <div>
                    <input type="text" id="tip_message" class="form-control" [formField]="dataForm.tip_message">

                </div>
            </div>
            <div class="input-group-control">
                <label for="error_message">错误提示</label>
                <div>
                    <input type="text" id="error_message" class="form-control" [formField]="dataForm.error_message">

                </div>
            </div>
            <div class="input-group-control">
                <label>编辑组</label>
                <div class="tab-group">
                    <app-check-input [source]="tabItems()" [formField]="dataForm.tab_name" />
                    <div class="flat-input">
                        <input type="text" class="form-control">
                        <button type="button" class="btn btn-info">添加</button>
                    </div>
                </div>
            </div>
            <div class="input-group-control">
                <label for="position">排序</label>
                <div>
                    <input type="number" id="position" class="form-control" [formField]="dataForm.position">

                </div>
            </div>
        </div>
        }
        <div class="btn-group">
            <app-action-button class="btn btn-primary" (tapped)="tapSubmit($event)" [disabled]="dataForm().invalid()">确认保存</app-action-button>
            <a class="btn btn-danger" (click)="tapBack()">取消修改</a>
        </div>
    </form>
</div>
